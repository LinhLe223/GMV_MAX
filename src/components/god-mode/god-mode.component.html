<div class="space-y-8">
  <div>
    <h2 class="text-2xl font-bold text-gray-900">üèÜ GOD MODE - Trung t√¢m Ch·ªâ huy</h2>
    <p class="mt-1 text-sm text-gray-500">D·ªØ li·ªáu h·ª£p nh·∫•t t·ª´ Ads, ƒê∆°n h√†ng, v√† T·ªìn kho ƒë·ªÉ ƒë∆∞a ra "S·ª± th·∫≠t Cu·ªëi c√πng": L·ª£i Nhu·∫≠n R√≤ng.</p>
  </div>

  <!-- Financial Health Bar -->
  @if(financialHealthBarData(); as health) {
    <div class="bg-white p-4 rounded-lg shadow border">
        <h3 class="text-sm font-medium text-gray-700 mb-2">S·ª©c Kh·ªèe D√≤ng Ti·ªÅn (NMV: {{ health.totalNmv | number:'1.0-0' }} ƒë)</h3>
        <div class="w-full flex h-6 rounded-full overflow-hidden text-xs text-white font-semibold">
            <div class="flex items-center justify-center bg-blue-500" [style.width.%]="health.cogsPercent" title="Gi√° v·ªën: {{ health.cogsPercent | number:'1.1-1' }}%">COGS</div>
            <div class="flex items-center justify-center bg-red-500" [style.width.%]="health.adsPercent" title="Chi ph√≠ Ads: {{ health.adsPercent | number:'1.1-1' }}%">ADS</div>
            <div class="flex items-center justify-center bg-yellow-500" [style.width.%]="health.feesPercent" title="Ph√≠ & Hoa h·ªìng: {{ health.feesPercent | number:'1.1-1' }}%">PH√ç</div>
            <div class="flex items-center justify-center" [class]="health.netProfitPercent >= 0 ? 'bg-green-500' : 'bg-gray-700'" [style.width.%]="health.netProfitPercent >= 0 ? health.netProfitPercent : 100 - health.cogsPercent - health.adsPercent - health.feesPercent" [title]="'L·ª£i nhu·∫≠n: ' + (health.netProfitPercent | number:'1.1-1') + '%'">
                @if(health.netProfitPercent >= 5) { L√ÉI }
            </div>
        </div>
    </div>
  }

  <!-- V2: Executive Summary -->
  @if(summary(); as s) {
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
      <div class="bg-white p-4 rounded-lg shadow border-l-4 border-blue-500">
        <div class="text-gray-500 text-sm">Doanh Thu Th·ª±c (NMV)</div>
        <div class="text-2xl font-bold text-blue-700">{{ s.totalNMV | number:'1.0-0' }} ‚Ç´</div>
        <div class="text-xs text-gray-400">GMV (ƒê∆°n): {{ s.totalRevenue | number:'1.0-0' }} ‚Ç´</div>
      </div>
      
      <div class="bg-white p-4 rounded-lg shadow border-l-4 border-green-500">
        <div class="text-gray-500 text-sm">L·ª£i Nhu·∫≠n R√≤ng</div>
        <div class="text-2xl font-bold" [class.text-red-600]="s.totalNetProfit < 0" [class.text-green-600]="s.totalNetProfit >= 0">
          {{ s.totalNetProfit | number:'1.0-0' }} ‚Ç´
        </div>
        <div class="text-xs text-gray-400">T·ª´ {{ s.totalNMV | number:'1.0-0' }} ƒë NMV</div>
      </div>

      <div class="bg-white p-4 rounded-lg shadow border-l-4 border-purple-500">
        <div class="text-gray-500 text-sm">Hi·ªáu Qu·∫£ KOC</div>
        <div class="text-2xl font-bold">{{ s.activeKoc }} / {{ s.totalKoc }}</div>
        <div class="text-xs text-gray-400">ƒêang ra ƒë∆°n</div>
      </div>

      <div class="bg-white p-4 rounded-lg shadow border-l-4 border-red-500">
        <div class="text-gray-500 text-sm">T·ª∑ L·ªá Ho√†n/H·ªßy</div>
        <div class="text-2xl font-bold text-red-600">{{ s.avgReturnRate | number:'1.1-1' }}%</div>
        <div class="text-xs text-gray-400">Tr√™n t·ªïng ƒë∆°n</div>
      </div>
    </div>
  }

  <!-- V2: AI Assistant -->
  <div class="bg-indigo-50 p-4 rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4">
    <div>
      <h3 class="font-bold text-indigo-800">ü§ñ Tr·ª£ l√Ω AI Ph√¢n t√≠ch & ƒê·ªÅ xu·∫•t</h3>
      <p class="text-xs text-indigo-600">Ch·ªçn ch·∫ø ƒë·ªô ph√¢n t√≠ch ph√π h·ª£p v·ªõi nhu c·∫ßu c·ªßa b·∫°n</p>
    </div>
    <div class="flex gap-2">
      <button (click)="analyzeAI('fast')" [disabled]="isAnalyzing()" class="px-4 py-2 bg-green-100 text-green-800 rounded-full hover:bg-green-200 border border-green-300 flex flex-col items-center disabled:opacity-50 disabled:cursor-wait">
        <span class="font-bold">üöÄ Nhanh</span>
        <span class="text-[10px]">Gemini 2.5 Flash</span>
      </button>
      <button (click)="analyzeAI('standard')" [disabled]="isAnalyzing()" class="px-4 py-2 bg-blue-100 text-blue-800 rounded-full hover:bg-blue-200 border border-blue-300 flex flex-col items-center disabled:opacity-50 disabled:cursor-wait">
        <span class="font-bold">‚öñÔ∏è Ti√™u Chu·∫©n</span>
        <span class="text-[10px]">Gemini 2.5 Pro</span>
      </button>
      <button (click)="analyzeAI('deep')" [disabled]="isAnalyzing()" class="px-4 py-2 bg-purple-100 text-purple-800 rounded-full hover:bg-purple-200 border border-purple-300 flex flex-col items-center disabled:opacity-50 disabled:cursor-wait">
        <span class="font-bold">üß† Chuy√™n S√¢u</span>
        <span class="text-[10px]">Gemini 2.5 Pro</span>
      </button>
    </div>
  </div>

  @if (isAnalyzing() || aiResult() || aiError()) {
    <div class="p-5 border border-gray-200 rounded-2xl bg-white shadow-sm min-h-[6rem]">
      @if (isAnalyzing() && !aiResult()) {
        <div class="flex items-center text-gray-500">
            <svg class="animate-spin h-5 w-5 mr-3" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>
            <span>AI ƒëang "suy nghƒ©", vui l√≤ng ch·ªù trong gi√¢y l√°t...</span>
        </div>
      } @else if (aiError()) {
        <div class="text-red-600">{{ aiError() }}</div>
      } @else if (aiResult() !== null) {
        <div class="prose prose-sm max-w-none text-gray-700" [innerHTML]="formatResponse(aiResult())"></div>
      }
    </div>
  }

  <!-- V2: BCG Matrix -->
  <div class="mb-6">
    <h3 class="font-bold text-gray-700 mb-2">üìä Ph√¢n lo·∫°i KOC (Ma tr·∫≠n BCG)</h3>
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <div (click)="filterBcg('STAR')" class="cursor-pointer transition-all p-3 rounded-lg relative border bg-yellow-50 border-yellow-200 hover:shadow-lg" [class.ring-4]="activeBcgFilter() === 'STAR'" [class.ring-yellow-300]="activeBcgFilter() === 'STAR'" [class.opacity-50]="activeBcgFilter() && activeBcgFilter() !== 'STAR'">
        <div class="absolute top-2 right-2 text-2xl">‚≠ê</div>
        <h4 class="font-bold text-yellow-800">NG√îI SAO</h4>
        <div class="text-xs text-gray-600">L·ª£i nhu·∫≠n Cao - GMV Cao</div>
        <div class="mt-2 font-bold text-lg text-yellow-900">{{ bcgGroups().STAR.length }} KOC</div>
        <div class="text-xs mt-1 text-gray-500 truncate h-4">
          @for(k of bcgGroups().STAR.slice(0, 5); track k.kocName){<span>{{ k.kocName }}, </span>}
        </div>
      </div>
       <div (click)="filterBcg('QUESTION')" class="cursor-pointer transition-all p-3 rounded-lg relative border bg-blue-50 border-blue-200 hover:shadow-lg" [class.ring-4]="activeBcgFilter() === 'QUESTION'" [class.ring-blue-300]="activeBcgFilter() === 'QUESTION'" [class.opacity-50]="activeBcgFilter() && activeBcgFilter() !== 'QUESTION'">
        <div class="absolute top-2 right-2 text-2xl">‚ùì</div>
        <h4 class="font-bold text-blue-800">D·∫§U H·ªéI</h4>
        <div class="text-xs text-gray-600">L·ª£i nhu·∫≠n Cao - GMV Th·∫•p</div>
        <div class="mt-2 font-bold text-lg text-blue-900">{{ bcgGroups().QUESTION.length }} KOC</div>
         <div class="text-xs mt-1 text-gray-500 truncate h-4">
          @for(k of bcgGroups().QUESTION.slice(0, 5); track k.kocName){<span>{{ k.kocName }}, </span>}
        </div>
      </div>
      <div (click)="filterBcg('COW')" class="cursor-pointer transition-all p-3 rounded-lg relative border bg-green-50 border-green-200 hover:shadow-lg" [class.ring-4]="activeBcgFilter() === 'COW'" [class.ring-green-300]="activeBcgFilter() === 'COW'" [class.opacity-50]="activeBcgFilter() && activeBcgFilter() !== 'COW'">
        <div class="absolute top-2 right-2 text-2xl">üêÆ</div>
        <h4 class="font-bold text-green-800">B√í S·ªÆA</h4>
        <div class="text-xs text-gray-600">L·ª£i nhu·∫≠n Th·∫•p - GMV Cao</div>
        <div class="mt-2 font-bold text-lg text-green-900">{{ bcgGroups().COW.length }} KOC</div>
         <div class="text-xs mt-1 text-gray-500 truncate h-4">
          @for(k of bcgGroups().COW.slice(0, 5); track k.kocName){<span>{{ k.kocName }}, </span>}
        </div>
      </div>
      <div (click)="filterBcg('DOG')" class="cursor-pointer transition-all p-3 rounded-lg relative border bg-gray-100 border-gray-200 hover:shadow-lg" [class.ring-4]="activeBcgFilter() === 'DOG'" [class.ring-gray-300]="activeBcgFilter() === 'DOG'" [class.opacity-50]="activeBcgFilter() && activeBcgFilter() !== 'DOG'">
        <div class="absolute top-2 right-2 text-2xl">üêï</div>
        <h4 class="font-bold text-gray-800">CH√ì M·ª∞C</h4>
        <div class="text-xs text-gray-600">L·ª£i nhu·∫≠n Th·∫•p - GMV Th·∫•p</div>
        <div class="mt-2 font-bold text-lg text-gray-900">{{ bcgGroups().DOG.length }} KOC</div>
         <div class="text-xs mt-1 text-gray-500 truncate h-4">
          @for(k of bcgGroups().DOG.slice(0, 5); track k.kocName){<span>{{ k.kocName }}, </span>}
        </div>
      </div>
    </div>
  </div>

  <div class="flex items-center justify-between">
    <div class="flex gap-x-2 rounded-full bg-slate-100 p-1.5">
      <button (click)="viewMode.set('koc')" [class]="viewMode() === 'koc' ? 'bg-white text-indigo-600 shadow-sm' : 'text-gray-600 hover:bg-slate-200/60'" class="px-5 py-2 rounded-full text-sm font-semibold transition-colors">
        üë§ B√°o C√°o KOC
      </button>
      <button (click)="viewMode.set('product')" [class]="viewMode() === 'product' ? 'bg-white text-indigo-600 shadow-sm' : 'text-gray-600 hover:bg-slate-200/60'" class="px-5 py-2 rounded-full text-sm font-semibold transition-colors">
        üì¶ B√°o C√°o S·∫£n Ph·∫©m
      </button>
    </div>
  </div>

  <div class="bg-white shadow-sm overflow-hidden rounded-2xl border border-gray-200">
    <div class="overflow-x-auto">
      <table class="min-w-full divide-y divide-gray-200">
        <thead class="bg-slate-50 text-xs uppercase text-slate-600">
           @if (viewMode() === 'koc') {
            <tr>
              <th (click)="onSort('kocName')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>KOC / K√™nh</span>
                  @if(sortKey() === 'kocName') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th class="group relative px-4 py-3 text-left font-semibold cursor-help">
                <div class="flex items-center">üõ°Ô∏è ROAS H√≤a V·ªën</div>
                <div class="absolute hidden group-hover:block bg-black text-white p-2 rounded text-xs w-48 z-50 shadow-lg">
                  M·ª©c ROAS t·ªëi thi·ªÉu ph·∫£i ƒë·∫°t ƒë·ªÉ kh√¥ng l·ªó. <br>
                  C√¥ng th·ª©c: (Doanh thu th·ª±c / L√£i g·ªôp th·ª±c)
                </div>
              </th>
              <th class="group relative px-4 py-3 text-left font-semibold cursor-help">
                <div class="flex items-center">üöÄ ROAS Th·ª±c</div>
                 <div class="absolute hidden group-hover:block bg-black text-white p-2 rounded text-xs w-48 z-50 shadow-lg">
                  Hi·ªáu qu·∫£ th·ª±c t·∫ø c·ªßa ti·ªÅn qu·∫£ng c√°o. <br>
                  C√¥ng th·ª©c: (Doanh thu th·ª±c / Chi ph√≠ Ads)
                </div>
              </th>
              <th (click)="onSort('daysOnHand')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>üì¶ T·ªìn Kho (Ng√†y)</span>
                  @if(sortKey() === 'daysOnHand') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th (click)="onSort('returnCancelPercent')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>üìâ Ho√†n/H·ªßy</span>
                  @if(sortKey() === 'returnCancelPercent') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th (click)="onSort('netProfit')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>üí∞ L√£i R√≤ng</span>
                  @if(sortKey() === 'netProfit') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th class="px-4 py-3 text-left font-semibold">ü§ñ AI L·ªánh</th>
              <th class="px-4 py-3 text-left font-semibold">H√†nh ƒë·ªông</th>
            </tr>
           } @else {
             <tr>
              <th (click)="onSort('productName')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>S·∫£n ph·∫©m</span>
                   @if(sortKey() === 'productName') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th class="group relative px-4 py-3 text-left font-semibold cursor-help">
                <div class="flex items-center">üõ°Ô∏è ROAS H√≤a V·ªën</div>
                <div class="absolute hidden group-hover:block bg-black text-white p-2 rounded text-xs w-48 z-50 shadow-lg">
                  M·ª©c ROAS t·ªëi thi·ªÉu ph·∫£i ƒë·∫°t ƒë·ªÉ kh√¥ng l·ªó. <br>
                  C√¥ng th·ª©c: (Doanh thu th·ª±c / L√£i g·ªôp th·ª±c)
                </div>
              </th>
              <th class="group relative px-4 py-3 text-left font-semibold cursor-help">
                 <div class="flex items-center">üöÄ ROAS Th·ª±c</div>
                 <div class="absolute hidden group-hover:block bg-black text-white p-2 rounded text-xs w-48 z-50 shadow-lg">
                  Hi·ªáu qu·∫£ th·ª±c t·∫ø c·ªßa ti·ªÅn qu·∫£ng c√°o. <br>
                  C√¥ng th·ª©c: (Doanh thu th·ª±c / Chi ph√≠ Ads)
                </div>
              </th>
               <th (click)="onSort('daysOnHand')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>üì¶ T·ªìn Kho (Ng√†y)</span>
                  @if(sortKey() === 'daysOnHand') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th (click)="onSort('returnRate')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>üìâ Ho√†n/H·ªßy</span>
                  @if(sortKey() === 'returnRate') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th (click)="onSort('netProfit')" class="px-4 py-3 text-left font-semibold cursor-pointer hover:bg-slate-200">
                <div class="flex items-center">
                  <span>üí∞ L√£i R√≤ng</span>
                  @if(sortKey() === 'netProfit') {<span class="ml-1">{{ sortDirection() === 'asc' ? '‚ñ≤' : '‚ñº' }}</span>}
                </div>
              </th>
              <th class="px-4 py-3 text-left font-semibold">ü§ñ AI L·ªánh</th>
              <th class="px-4 py-3 text-left font-semibold">H√†nh ƒë·ªông</th>
            </tr>
           }
        </thead>
        <tbody class="divide-y divide-gray-200 text-sm">
          @for(item of paginatedData(); track item.kocName || item.productId) {
            <ng-container>
                <tr class="hover:bg-slate-50" [class.bg-red-50]="item.netProfit < 0">
                <td (click)="viewMode() === 'koc' ? selectKoc(item) : null" class="px-4 py-3 font-medium text-indigo-600" [class.cursor-pointer]="viewMode() === 'koc'">
                    {{ item.kocName || item.productName }}
                    @if(viewMode() === 'koc') {
                    <span class="text-xs ml-1 text-gray-400">{{ selectedKoc() === item ? '‚ñº' : '‚ñ∂' }}</span>
                    }
                </td>
                <td class="px-4 py-3">{{ item.breakEvenRoas === Infinity ? 'N/A' : (item.breakEvenRoas | number:'1.1-1') }}</td>
                <td class="px-4 py-3 font-semibold" [class.text-red-600]="item.healthStatus === 'BLEEDING'">
                    {{ item.realRoas | number:'1.1-1' }}
                    @if(item.healthStatus === 'BLEEDING') {<span>üíÄ</span>}
                </td>
                <td class="px-4 py-3 text-center">
                    <span [class.text-red-600]="item.daysOnHand < 7 && item.daysOnHand > 0" class="font-bold">
                        {{ item.daysOnHandDisplay }}
                    </span>
                    <div class="text-[10px] text-gray-400">SL: {{ item.stockQuantity | number:'1.0-0' }}</div>
                </td>
                <td class="px-4 py-3">{{ (item.returnCancelPercent ?? item.returnRate) | number:'1.1-1' }}%</td>
                <td class="px-4 py-3 font-bold" [class.text-red-600]="item.netProfit < 0" [class.text-green-600]="item.netProfit >= 0">
                    {{ item.netProfit | number:'1.0-0' }} ƒë
                </td>
                <td class="px-4 py-3 font-semibold text-xs">{{ item.aiCommand }}</td>
                <td class="px-4 py-3">
                    <button (click)="openWarRoom(item)" class="px-2 py-1 bg-slate-200 text-slate-800 rounded-md text-xs font-semibold hover:bg-slate-300">‚ö° H√†nh ƒê·ªông</button>
                </td>
                </tr>

                @if (viewMode() === 'koc' && selectedKoc() === item) {
                <tr class="bg-slate-50">
                    <td colspan="8" class="p-4 border-l-4 border-indigo-500">
                    <h4 class="text-sm font-semibold mb-2 text-gray-700">üîç Chi ti·∫øt Video c·ªßa {{ item.kocName }}</h4>
                    <table class="w-full bg-white border rounded-lg">
                        <thead>
                        <tr class="text-xs bg-indigo-50">
                            <th class="p-2 text-left">Video ID / Link</th>
                            <th class="p-2 text-left">S·∫£n Ph·∫©m</th>
                            <th class="p-2 text-right">Doanh Thu (NMV)</th>
                            <th class="p-2 text-right">Chi Ph√≠ Ads</th>
                            <th class="p-2 text-right">L·ª£i Nhu·∫≠n</th>
                        </tr>
                        </thead>
                        <tbody class="divide-y">
                        @for (video of sortedKocDetails(); track video.videoId) {
                            <tr>
                            <td class="p-2 text-xs">
                                <a [href]="getTikTokVideoLink(item.kocName, video.videoId)" target="_blank" class="text-blue-600 hover:underline inline-flex items-center">
                                <span>{{ video.videoId || 'Kh√¥ng c√≥ ID' }}</span>
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" /></svg>
                                </a>
                            </td>
                            <td class="p-2 text-xs">{{ video.productName }}</td>
                            <td class="p-2 text-right text-xs">{{ video.nmv | number }}</td>
                            <td class="p-2 text-right text-xs">{{ video.cost | number }}</td>
                            <td class="p-2 text-right text-xs font-bold" [class.text-red-500]="video.profit < 0">{{ video.profit | number }}</td>
                            </tr>
                        } @empty {
                            <tr><td colspan="5" class="p-4 text-center text-xs text-gray-500">Kh√¥ng c√≥ d·ªØ li·ªáu chi ti·∫øt.</td></tr>
                        }
                        </tbody>
                    </table>
                    </td>
                </tr>
                }
            </ng-container>
          } @empty {
            <tr><td colspan="8" class="text-center py-10 text-gray-500">Kh√¥ng c√≥ d·ªØ li·ªáu ƒë·ªÉ hi·ªÉn th·ªã.</td></tr>
          }
        </tbody>
      </table>
    </div>
    @if (sortedData().length > 0) {
      <app-pagination [totalItems]="sortedData().length" [itemsPerPage]="itemsPerPage()" [currentPage]="currentPage()" (pageChange)="onPageChange($event)" (itemsPerPageChange)="onItemsPerPageChange($event)"></app-pagination>
    }
  </div>
</div>

<!-- War Room Modal -->
@if (isWarRoomOpen()) {
  <div class="fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity z-40" (click)="closeWarRoom()"></div>
  <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
    <div class="relative bg-white rounded-2xl shadow-xl w-full max-w-lg" (click)="$event.stopPropagation()">
      <div class="flex items-start justify-between p-4 border-b rounded-t">
        <h3 class="text-xl font-semibold text-gray-900">
          Ph√≤ng T√°c chi·∫øn: <span class="text-indigo-600">{{ warRoomItem().kocName || warRoomItem().productName }}</span>
        </h3>
        <button type="button" (click)="closeWarRoom()" class="text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center">
          <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
        </button>
      </div>
      <div class="p-6 space-y-4">
        <div>
          <label for="action-select" class="block text-sm font-medium text-gray-700">Ch·ªçn h√†nh ƒë·ªông:</label>
          <select id="action-select" [value]="warRoomAction()" (change)="warRoomAction.set($event.target.value)" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
            <option value="">-- Ch·ªçn --</option>
            <option value="TƒÉng ng√¢n s√°ch">TƒÉng ng√¢n s√°ch</option>
            <option value="Gi·∫£m ng√¢n s√°ch">Gi·∫£m ng√¢n s√°ch</option>
            <option value="D·ª´ng/T·∫°m d·ª´ng">D·ª´ng/T·∫°m d·ª´ng</option>
            <option value="G·ª≠i c·∫£nh b√°o">G·ª≠i c·∫£nh b√°o</option>
            <option value="Y√™u c·∫ßu t·ªëi ∆∞u">Y√™u c·∫ßu t·ªëi ∆∞u</option>
          </select>
        </div>
        <div>
          <label for="action-notes" class="block text-sm font-medium text-gray-700">Ghi ch√∫:</label>
          <textarea id="action-notes" rows="3" [value]="warRoomNotes()" (input)="warRoomNotes.set($event.target.value)" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"></textarea>
        </div>
      </div>
      <div class="flex items-center justify-end p-4 border-t">
        <button (click)="closeWarRoom()" type="button" class="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">H·ªßy</button>
        <button (click)="saveWarRoomAction()" type="button" class="ml-3 inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700">L∆∞u v√†o Log</button>
      </div>
    </div>
  </div>
}