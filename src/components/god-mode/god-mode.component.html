<div class="space-y-8">
  <div>
    <h2 class="text-2xl font-bold text-gray-900">ğŸ† GOD MODE - Master P&L Table</h2>
    <p class="mt-1 text-sm text-gray-500">Báº£ng phÃ¢n tÃ­ch Lá»£i nhuáº­n & Lá»— (P&L) thá»±c táº¿ cá»§a tá»«ng KOC sau khi há»£p nháº¥t dá»¯ liá»‡u Ads, Orders vÃ  Inventory.</p>
  </div>
  <div class="bg-white shadow-sm overflow-hidden rounded-2xl border border-gray-200">
    <table class="min-w-full text-sm border-collapse">
      <thead class="bg-gray-100 text-gray-700 sticky top-0">
        <tr>
          <th class="p-3 text-left">KOC</th>
          <th class="p-3 bg-red-50 text-red-700 cursor-pointer" (click)="sort('adsCost')">
            ğŸ”´ Chi PhÃ­ Ads â‡…
          </th>
          <th class="p-3 text-gray-600 cursor-pointer" (click)="sort('cogs')">
            ğŸ“¦ GiÃ¡ Vá»‘n â‡…
          </th>
          <th class="p-3 text-gray-600">
            ğŸ’¸ Hoa Há»“ng
          </th>
          <th class="p-3 bg-blue-50 text-blue-700 cursor-pointer" (click)="sort('nmv')">
            ğŸŸ¢ NMV (Thá»±c Thu) â‡…
          </th>
          <th class="p-3 text-center cursor-pointer" (click)="sort('realRoas')">
            ğŸš€ ROAS Thá»±c â‡…
          </th>
          <th class="p-3 bg-green-50 text-green-800 cursor-pointer" (click)="sort('netProfit')">
            ğŸ’° Lá»£i Nhuáº­n RÃ²ng â‡…
          </th>
        </tr>
      </thead>
      <tbody>
        @for (item of sortedData(); track item.mergeKey) {
          <tr class="border-b hover:bg-gray-50">
            <td class="p-3 font-medium">{{ item.kocName }}</td>
            <td class="p-3 font-bold text-red-600">{{ item.adsCost | number }}</td>
            <td class="p-3 text-gray-500">{{ item.cogs | number }}</td>
            <td class="p-3 text-gray-500">{{ item.commission | number }}</td>
            <td class="p-3 font-bold text-blue-600">{{ item.nmv | number }}</td>
            <td class="p-3 text-center">
              <span class="px-2 py-1 rounded font-bold" 
                    [class.bg-green-100]="item.realRoas > 3" 
                    [class.bg-red-100]="item.realRoas < 2">
                {{ item.realRoas | number:'1.1-2' }}
              </span>
            </td>
            <td class="p-3 font-bold text-lg" 
                [class.text-green-600]="item.netProfit > 0" 
                [class.text-red-600]="item.netProfit <= 0">
              {{ item.netProfit | number }}
            </td>
          </tr>
        } @empty {
           <tr>
            <td colspan="7" class="text-center p-8 text-gray-500">
              KhÃ´ng cÃ³ dá»¯ liá»‡u P&L Ä‘á»ƒ hiá»ƒn thá»‹. <br/> Vui lÃ²ng táº£i lÃªn file Ads, file ÄÆ¡n hÃ ng, vÃ  file Tá»“n kho.
            </td>
          </tr>
        }
      </tbody>
    </table>
  </div>
</div>
